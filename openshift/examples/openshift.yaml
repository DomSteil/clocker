id: openshift
name: "openshift"
description: |
  Creates an OpenShift Origin 1.4.1 cluster with load balanced master servers
  on CentOS 7 virtual machines.

  Scheduled repave of 2 machines is run daily at 02h30.

  Host file for openshift.local access is copied to localhost.

location: aws-eu-central-1

services:
  - type: openshift-origin-template
    id: openshift
    name: "openshift"
    brooklyn.config:
      # configure opesnhift
      openshift.version: 1.4.1
      # configure repave policy
      openshift.repave.size: 2
      openshift.repave.period: 1 day
      openshift.repave.start: 02:30:00
      # set cluster size
      openshift.master.clusterSize: 2
      openshift.etcd.clusterSize: 3
      openshift.node.clusterSize: 5
      # set machine config
      openshift.master.minCores: 2
      openshift.master.minRam: 4000
      openshift.node.minCores: 4
      openshift.node.minRam: 8000
      openshift.etcd.minCores: 1
      openshift.etcd.minRam: 2000
      openshift.lb.minCores: 1
      openshift.lb.minRam: 2000
      # set shared machine details
      openshift.domain: "openshift.local"
      openshift.ssh.loginUser: "amp"
      openshift.ssh.privateKeyFile: "~/.ssh/openshift.pem"

  # local access to openshift.local hosts
  - type: empty-software-process
    id: localhost
    name: "localhost"
    location: localhost
    brooklyn.config:
      openshift.configureHostsFile: true
